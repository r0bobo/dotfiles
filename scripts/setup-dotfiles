#!/usr/bin/env zsh

echo -e "\033[1mtest\033[0m"

# Set paths
: ${DOTFILES_DIR:=~/dotfiles}
source $DOTFILES_DIR/zsh/paths.sh

# Run python script to setup symlinks
$DOTFILES_DIR/scripts/create_symlinks.py $DOTFILES_DIR $DOTFILES_DIR/dotfiles.conf

# Download modules
if [ ! -d "$ZPLUG_HOME" ]; then
        echo "Installing zplug..."
        git clone https://github.com/zplug/zplug $ZPLUG_HOME
else
        echo "zplug already installed."
fi
if [ ! -d "$VIMLPUG_HOME" ]; then
        echo "Installing vim-plug..."
        curl -fLo $VIMPLUG_HOME --create-dirs \
                https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
else
        echo "vim-plug already installed."
fi
if [ ! -d "$ZSH" ]; then
        echo "Installing oh-my-zsh..."
        git clone https://github.com/robbyrussell/oh-my-zsh $ZSH
else
        echo "oh-my-zsh already installed."
fi

# Source zsh-config
source $DOTFILES_DIR/zsh/init.zsh

# Run and update zplug
# TODO: Use zplug check and zplug status to only install/update if necessary

zplug clear
zplug list
zplug check || zplug install
zplug clean --force
zplug load --verbose

# Run and update vim-plug
nvim -c "PlugUpgrade | PlugInstall | PlugUpdate | PlugClean! | q | q"

