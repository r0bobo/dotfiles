#!/usr/bin/env zsh

TIMEFMT=$'%E'
ZSH="$(which zsh)"

cat <<EOF
---------------------------------------
LOOP    BASE    USERCONFIG    OVERHEAD
---------------------------------------
EOF

for i in $(seq 1 10); do
    basetime="$({ ZSH_NO_USER_CONFIG=true \time -f %U "$ZSH" -i -c exit } 2>&1)"
    usertime="$({ \time -f %U "$ZSH" -i -c exit } 2>&1)"
    overhead="$(echo "$usertime - $basetime" | bc)"
    cat <<EOF
$(printf %2s $i)      $basetime    $usertime          $(printf '%0.2f' $overhead)
EOF
done
